var fetchSheet={async fetch({gSheetId:e,wSheetName:t,range:s,query:a,accessToken:r}){let c=`https://docs.google.com/spreadsheets/d/${e}/gviz/tq?tqx=out:csv`;t&&(c+=`&sheet=${t}`),s&&(c+=`&range=${s}`),a&&(c+=`&tq=${a}`),r&&(c+=`&access_token=${r}`);let i=await fetch(c);if(200!=i.status)return[];let l=await i.text(),{header:n,rows:h}=this.parseCsv(l);return this.array2Json(h,n)},parseCsv(e){let t=e.slice(1,e.length-1).split(/\"\n\"/).map(e=>e.split('","')),s=t.splice(0,1)[0];return s=s.reduce((e,t,s)=>({...e,[t]:s}),{}),{header:s,rows:t}},array2Json:(e,t)=>e.map(e=>e.reduce((s,a,r)=>({...s,[Object.keys(t)[r]]:e[r]}),{}))};
